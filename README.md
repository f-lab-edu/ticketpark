# 티켓 예약 사이트

- 현재 운영되고 있는 티켓 사이트를 모티브로 만든 공연 예매 API 서버 토이 프로젝트입니다. 
- 공연 예매 상황에서의 트래픽 처리 구현에 집중하고자 로그인, 결제와 같은 기능의 상세한 구현은 추후 구현하고자 합니다.

## 비즈니스 요구사항

- 사용자
    - 사용자는 공연 예매 서비스를 사용하기 위해서 회원가입이 필요하다.
    - 로그인이 안된 사용자는 공연 예매를 할 수 없다.
    - 로그인된 사용자는 예매된 공연 정보가 가능하다.
        - 예매 확인 / 예매 취소

- 회원가입
    - 회원 가입을 위해 필요한 정보는 아래와 같다.
        - 아이디, 비밀번호, 이메일, 휴대폰번호 
    - 사용자는 아이디가 다른 사용자와 중복되지 않아야 한다.
    - 사용자는 아이디, 비밀번호를 제외한 이메일, 휴대폰번호의 변경이 가능하다.

- 예매
    - 각 공연은 예매 가능 시간이 있으며 예매 가능 시간 이후 예매가 가능하다.
    - 예매를 위해서는 공연이 진행되는 날짜, 공연 시간, 좌석의 위치, 티켓 매수를 선택해야 한다.
   
- 결제
    - 공연 예매 결제에 성공한 회원은 예매 확인 정보가 조회 가능하다.
    - 결제가 완료된 좌석은 예매를 진행할 수 없다.
    - 결제가 취소된 좌석은 예매를 진행할 수 있다.

## ERD

## Technical Issue
- 트래픽 처리 관련
    1) DB에서의 구현?
        - DB IO가 많이 발생할텐데 괜찮은지?
        - 어떤 DB 선택할지?
            - maria db나 postgreSql 고려 중인데 postgreSql은 dirty read가 지원안되는 걸로 알아서 구현이나 디버깅이 쉽지 않을거 같다.
    
    2) Redis에서의 구현
        - DB에서의 IO 부담을 Redis에 넘기는 방향
        - 나중에는 Redis에 있는 공연 성공한 사람들의 아이디 리스트를 DB에 bulkInsert로 반영해야 한다.
            - bulkInsert에 대한 부하 우려
                ex) 고척돔의 경우 최소 2만건의 bulkInsert가 일어날지도?
            - bulkInsert는 Spring batch로 새벽에 실행되는 방향으로 진행하는게 맞는지?  

    3) 락에 대한 고민
    - 클라이언트 무조건 대기되도록 할지?
- 클라이언트가 예매창에는 접속 가능하도록 하고 결제가 되는 그 타이밍만 정합성 맞추도록 할지?
- 대기가 없다면 예매창 사이트에 트래픽이 엄청 몰릴텐데 최소한의 대기 기준을 둬야 하는건지?
